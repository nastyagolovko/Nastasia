# [–ú–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã](https://github.com/nastyagolovko/Nastasia/blob/master/README.md#%D0%BC%D0%B5%D1%82%D1%80%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B5-%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%D1%8B)

[–ê–ª–≥–æ—Ä–∏—Ç–º 1NN](https://github.com/nastyagolovko/Nastasia/blob/master/README.md#%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC-1nn)

[–ê–ª–≥–æ—Ä–∏—Ç–º kNN](https://github.com/nastyagolovko/Nastasia/blob/master/README.md#%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC-knn)

[–ú–µ—Ç–æ–¥ –ø–∞—Ä–∑–µ–Ω–æ–≤—Å–∫–æ–≥–æ –æ–∫–Ω–∞](https://github.com/nastyagolovko/Nastasia/blob/master/README.md#%D0%BC%D0%B5%D1%82%D0%BE%D0%B4-%D0%BF%D0%B0%D1%80%D0%B7%D0%B5%D0%BD%D0%BE%D0%B2%D1%81%D0%BA%D0%BE%D0%B3%D0%BE-%D0%BE%D0%BA%D0%BD%D0%B0)

[–ê–ª–≥–æ—Ä–∏—Ç–º –°–¢–û–õ–ü (STOLP)](https://github.com/nastyagolovko/Nastasia/blob/master/README.md#%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC-%D1%81%D1%82%D0%BE%D0%BB%D0%BF-stolp)

[–ú–µ—Ç–æ–¥ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π](https://github.com/nastyagolovko/Nastasia/blob/master/README.md#%D0%BC%D0%B5%D1%82%D0%BE%D0%B4-%D0%BF%D0%BE%D1%82%D0%B5%D0%BD%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D1%85-%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%B9)

[–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏](https://github.com/nastyagolovko/Nastasia#%D1%81%D1%80%D0%B0%D0%B2%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5-%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%D0%BE%D0%B2-%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D0%B8)

# [–ë–∞–π–µ—Å–æ–≤—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏](https://github.com/nastyagolovko/Nastasia#%D0%B1%D0%B0%D0%B9%D0%B5%D1%81%D0%BE%D0%B2%D1%81%D0%BA%D0%B8%D0%B5-%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D1%8B-%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%B8%D1%84%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D0%B8)

[–õ–∏–Ω–∏–∏ —É—Ä–æ–≤–Ω—è](https://github.com/nastyagolovko/Nastasia#%D0%BB%D0%B8%D0%BD%D0%B8%D0%B8-%D1%83%D1%80%D0%BE%D0%B2%D0%BD%D1%8F)

[–ü–æ–¥—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º](https://github.com/nastyagolovko/Nastasia#%D0%BF%D0%BE%D0%B4%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BE%D1%87%D0%BD%D1%8B%D0%B9-%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82)

[–õ–∏–Ω–µ–π–Ω—ã–π –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç –§–∏—à–µ—Ä–∞](https://github.com/nastyagolovko/Nastasia#%D0%BB%D0%B8%D0%BD%D0%B5%D0%B9%D0%BD%D1%8B%D0%B9-%D0%B4%D0%B8%D1%81%D0%BA%D1%80%D0%B8%D0%BC%D0%B8%D0%BD%D0%B0%D0%BD%D1%82-%D1%84%D0%B8%D1%88%D0%B5%D1%80%D0%B0)

# –ú–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
# –ê–ª–≥–æ—Ä–∏—Ç–º 1NN
–ü–æ–¥–±–∏—Ä–∞–µ—Ç—Å—è –º–µ—Ç—Ä–∏–∫–∞. –í –¥–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ —ç—Ç–æ –¥–µ–∫–∞—Ä—Ç–æ–≤–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –≤–µ–∫—Ç–æ—Ä–∞–º–∏.
–û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞ —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ –ø–æ—Ä—è–¥–∫–µ —É–≤–µ–ª–∏—á–µ–Ω–∏—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –æ—Ç –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞.
–≠–ª–µ–º–µ–Ω—Ç –æ—Ç–Ω–æ—Å—è—Ç –∫ —Ç–æ–º—É –∫–ª–∞—Å—Å—É –∫ –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –±–ª–∏–∂–∞–π—à–∏–π (–ø–µ—Ä–≤—ã–π –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ) —ç–ª–µ–º–µ–Ω—Ç.

<p><img src= "1NN.jpg">
  
## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

* –ø—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏;

* –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å —Ä–µ—à–µ–Ω–∏–π;

## –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:

* –Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏;

* –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è —Ö—Ä–∞–Ω–∏—Ç—å –≤—Å—é –≤—ã–±–æ—Ä–∫—É —Ü–µ–ª–∏–∫–æ–º.

# –ê–ª–≥–æ—Ä–∏—Ç–º kNN
–î–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–∞–∂–¥–æ–≥–æ –∏–∑ –æ–±—ä–µ–∫—Ç–æ–≤ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:

* –í—ã—á–∏—Å–ª–∏—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –∫–∞–∂–¥–æ–≥–æ –∏–∑ –æ–±—ä–µ–∫—Ç–æ–≤ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏

* –û—Ç–æ–±—Ä–∞—Ç—å k –æ–±—ä–µ–∫—Ç–æ–≤ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –∫–æ—Ç–æ—Ä—ã—Ö –º–∏–Ω–∏–º–∞–ª—å–Ω–æ

* –ö–ª–∞—Å—Å –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ ‚Äî —ç—Ç–æ –∫–ª–∞—Å—Å, –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏–π—Å—è —Å—Ä–µ–¥–∏ k –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π
kNN ‚Äî –æ–¥–∏–Ω –∏–∑ –ø—Ä–æ—Å—Ç–µ–π—à–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, –ø–æ—ç—Ç–æ–º—É –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö –æ–Ω –∑–∞—á–∞—Å—Ç—É—é –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º. –ü–æ–º–∏–º–æ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, –ø—Ä–æ–±–ª–µ–º–æ–π —ç—Ç–æ–≥–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ —è–≤–ª—è–µ—Ç—Å—è —Å–∫–æ—Ä–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: –µ—Å–ª–∏ –≤ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ N –æ–±—ä–µ–∫—Ç–æ–≤, –≤ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–µ M –æ–±—ä–µ–∫—Ç–æ–≤, –∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ ‚Äî K, —Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ü–µ–Ω–µ–Ω–æ –∫–∞–∫ O(K*M*N). –ò —Ç–µ–º –Ω–µ –º–µ–Ω–µ–µ, –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã kNN —è–≤–ª—è–µ—Ç—Å—è —Ö–æ—Ä–æ—à–∏–º –ø—Ä–∏–º–µ—Ä–æ–º –¥–ª—è –Ω–∞—á–∞–ª–∞ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞ —Å Machine Learning.


   
  ``` R
  –ó–∞–¥–∞–µ–º –µ–≤–∫–ª–∏–¥–æ–≤–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ
  uclideanDistance <- function(u, v)
   {
   sqrt(sum(u - v)^2)
   }
   ``` 
   
``` R
 –ü—Ä–∏–º–µ–Ω—è–µ–º –º–µ—Ç–æ–¥ kNN 
 kNN <- function(xl, z, k) {    
 
–°–æ—Ä—Ç–∏—Ä—É–µ–º –≤—ã–±–æ—Ä–∫—É —Å–æ–≥–ª–∞—Å–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞     
 orderedXl <- sortObjectsByDist(xl, z)     
 n <- dim(orderedXl)[2] - 1         
 
  –ü–æ–ª—É—á–∞–µ–º –∫–ª–∞—Å—Å—ã –ø–µ—Ä–≤—ã—Ö k —Å–æ—Å–µ–¥–µ–π    
 classes <- orderedXl[1:k, n + 1] 
```


<p><img src= "photofacefun_com_1539847206.jpg">

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

* –ü—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–∞.

* –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ª–µ–≥–∫–æ –ø–æ–¥–¥–∞—ë—Ç—Å—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏. 

* –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞, –ø—É—Ç—ë–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π —Å–æ—á–µ—Ç–∞–Ω–∏—è –∏ –º–µ—Ç—Ä–∏–∫ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–¥—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∑–∞–¥–∞—á—É.

–ü—Ä–æ–±–ª–µ–º—ã:

* –ú–æ–¥–µ–ª—å –Ω–µ–ª—å–∑—è "–æ—Ç–¥–µ–ª–∏—Ç—å" –æ—Ç –¥–∞–Ω–Ω—ã—Ö: –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ –ø—Ä–∏–º–µ—Ä—ã. –≠—Ç–∞ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å —Å–∏–ª—å–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞


<p><img src= "loo.png">
  <p><img src= "kwnn.png">

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ kNN –∏ kwNN.
kNN ‚Äî –æ–¥–∏–Ω –∏–∑ –ø—Ä–æ—Å—Ç–µ–π—à–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, –ø–æ—ç—Ç–æ–º—É –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö –æ–Ω –∑–∞—á–∞—Å—Ç—É—é –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º. –û—Å–Ω–æ–≤–Ω—ã–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞  —è–≤–ª—è–µ—Ç—Å—è —Ç–æ—á–Ω–æ—Å—Ç—å –∏ —Å–∫–æ—Ä–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: –µ—Å–ª–∏ –≤ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ N –æ–±—ä–µ–∫—Ç–æ–≤, –≤ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–µ M –æ–±—ä–µ–∫—Ç–æ–≤, –∞ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ ‚Äî K, —Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ü–µ–Ω–µ–Ω–æ –∫–∞–∫ O(KMN).
–∫–∞—Ü–∏–∏.

```R
–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–∞ kNN –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤—ã–±–æ—Ä–∫–∏ —Å–æ–≥–ª–∞—Å–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –∏ —Ä—Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è
  KWNN <- function(xl, z, k, q) { 
  orderedXl <- sortObjectsByDist(xl, z, euclideanDistance)
 
 
  –ú–µ—Ç–æ–¥ —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ k
   LOOKWNN <- function(classificator){                    
   j <- 1
   LOO <- seq(1, length(segment))
  
  
  –ë–µ—Ä–µ–º —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –ø–æ —Ç–æ–ª–±—Ü–∞–º –∏ –ø–æ–ª—É—á–∞–µ–º –∫–ª–∞—Å—Å –ø–µ—Ä–≤—ã—Ö k —Å–æ—Å–µ–¥–µ–π
    n <- dim(orderedXl)[2] - 1 
    classes <- orderedXl[1:k, n + 1]
  
  
  –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
    w <- q ^ i                                             
    m[[classes[i]]] <- m[[classes[i]]] + w                  
  }
```
kwNN –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç kNN, —Ç–µ–º —á—Ç–æ —É—á–∏—Ç—ã–≤–∞–µ—Ç –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Å–µ–¥–µ–π –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ–º–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞, —É–ª—á—à–∞—è –∫–∞—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.

# –ú–µ—Ç–æ–¥ –ø–∞—Ä–∑–µ–Ω–æ–≤—Å–∫–æ–≥–æ –æ–∫–Ω–∞ 
–í –¥–∞–Ω–Ω–æ–º –º–µ—Ç–æ–¥–µ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤–µ—Å–æ–≤—É—é —Ñ–Ω–∫—Ü–∏—é –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—é —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è. –î–ª—è —Ä–µ–∞–∞–ª–∏–∞—Ü–∏–∏ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä h, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–∑—ã–≤–∞–µ–º —à–∏—Ä–∏–Ω–æ–π –æ–∫–Ω–∞. –î–∞–Ω–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –∏—Å–ø–æ–ª–∑—É–µ–º –ø—Ä–º–µ—Ä–Ω–æ —Ç–∞–∫ –∂–µ –∫–∞–∫ –∏ —á–∏—Å–ª–æ —Å–æ—Å–µ–¥–µ–π k.

–ü—Ä–æ–≥—Ä–∞–º–Ω—ã–π –∫–æ–¥:
```R
parzen <- function(xl, h, distances, type_core) {
 *–û—Ü–µ–Ω–∫–∞ –≤–µ—Å–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é, –∞ –Ω–µ –ø–æ —Ä–∞–Ω–≥—É; 
 *h- —à–∏—Ä–∏–Ω–∞ –æ–∫–Ω–∞; 
 *distances-—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Ç–æ—á–∫–∏ z –¥–æ –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –≤—ã–±–æ—Ä–∫–∏ xl;
 *type_core- —Ç–µ–∫—É—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è —è–¥—Ä–∞


–ö–ª–∞—Å—Å—ã –æ–±—ä–µ–∫—Ç–æ–≤ –≤—ã–±–æ—Ä–∫–∏ –∏ —Ç–∞–±–ª–∏—Ü–∞ –≤–µ—Å–æ–≤ –∫–ª–∞—Å—Å–æ–≤
  classes <- xl[1:l, n] 
  weights <- table(classes) 
  weights[1:length(weights)] <- 0
  
  
  –ü—Ä–∏–±–∞–≤–ª—è–µ–º –µ–≥–æ –≤–µ—Å –∫ –æ–±—â–µ–º—É –≤–µ—Å—É –µ–≥–æ –∫–ª–∞—Å—Å–∞
    r <- distances[i] / h
    weights[class] <- weights[class] + type_core(r) 
  }


–ï—Å–ª–∏ –≤–µ—Å–∞ —Ç–æ—á–∫–∏ –ø–æ –∫–ª–∞—Å—Å–∞–º –Ω–µ —Ä–∞–≤–Ω—ã 0, —Ç–æ —Ç–æ—á–∫–∞ –ø–æ–ø–∞–ª–∞ –≤ –æ–∫–Ω–æ; –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–ª–∞—Å—Å —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –≤–µ—Å–æ–º 
   if (max(weights) != 0) 
      return (names(which.max(weights))) 
   else
      return (0) 
```

<p><img src= "E.png">
  
  core.E <- function(r) (3/4)*(1-r^2)*(abs(r) <= 1) –Ø–¥—Ä–æ –ï–ø–∞–Ω–µ—á–Ω–∏–∫–æ–≤–∞
  
<p><img src= "Q.png">
  
  core.Q <- function(r) (15/16)*((1 - r^2)^2)*(abs(r) <= 1) –ö–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å—Å–∫–æ–µ —è–¥—Ä–æ
  
<p><img src= "T.png">
  
  core.T <- function(r) (1 - abs(r))*(abs(r) <= 1) –¢—Ä–µ—É–≥–æ–ª—å–Ω–æ–µ —è–¥—Ä–æ
  
<p><img src= "G.png">
  
  core.G <- function(r) (2*pi)^(-0.5)*exp(-0.5*(r^2)) –ì–∞—É—Å—Å–æ–≤—Å–∫–æ–µ —è–¥—Ä–æ
  
  
<p><img src= "–ø–∞—Ä–∑–æ–∫–Ω–æ.png">
  
  core.P <- function(r) (0.5)*(abs(r) <= 1) –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–µ —è–¥—Ä–æ
  

<p><img src= "–≥—Ä–∞—Ñ–∏–∫–∏ —è–¥–µ—Ä.png">


```R
core.E <- function(r) (3/4)*(1-r^2)*(abs(r) <= 1) –Ø–¥—Ä–æ –ï–ø–∞–Ω–µ—á–Ω–∏–∫–æ–≤–∞
core.Q <- function(r) (15/16)*((1 - r^2)^2)*(abs(r) <= 1) –ö–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å—Å–∫–æ–µ —è–¥—Ä–æ
core.T <- function(r) (1 - abs(r))*(abs(r) <= 1) –¢—Ä–µ—É–≥–æ–ª—å–Ω–æ–µ —è–¥—Ä–æ
core.G <- function(r) (2*pi)^(-0.5)*exp(-0.5*(r^2)) –ì–∞—É—Å—Å–æ–≤—Å–∫–æ–µ —è–¥—Ä–æ
core.P <- function(r) (0.5)*(abs(r) <= 1) –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–µ —è–¥—Ä–æ
```



# –ê–ª–≥–æ—Ä–∏—Ç–º –°–¢–û–õ–ü (STOLP)
–ê–ª–≥–æ—Ä–∏—Ç–º –°–¢–û–õ–ü (STOLP) ‚Äî –∞–ª–≥–æ—Ä–∏—Ç–º –æ—Ç–±–æ—Ä–∞ —ç—Ç–∞–ª–æ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è –º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞. 
–†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —è–≤–ª—è–µ—Ç—è —Ä–∞–∑–±–∏–µ–Ω–µ –æ–±—É—á–∞—é—â–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ 3 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: —à—É–º–æ–≤—ã–µ, —ç—Ç–∞–ª–æ–Ω–Ω—ã–µ –∏ –Ω–µ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –ï—Å–ª–∏ –≥–∏–ø–æ—Ç–µ–∑–∞ –∫–æ–º–ø–∞–∫—Ç–Ω–æ—Å—Ç–∏ –≤–µ—Ä–Ω–∞. —Ç–æ –≤—ã–±–æ—Ä–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–µ–ª–∏–∫–∞, —Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è –º–∞—Å—Å–∞ –æ–±—É—á–∞—é—â—Ö –æ–±—ä–∫—Ç–æ–≤ –æ–∫–∞–∂–µ—Ç—Å—è –Ω–∞–∏–Ω—Ñ–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –∏ –±—É–¥–µ—Ç –æ—Ç–±—Ä–æ—à–µ–Ω–∞. –§–∞–∫—Ç–∏—á–µ—Å–∫–∏, —ç—Ç–æ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–∂–∞—Ç–∏–µ –∏—Å–æ–¥–Ω—ã—Ö –¥–∞–Ω—ã—Ö.
<p><img src= "–æ–±—ä–µ–∫—Ç—ã.png">

# –ú–µ—Ç–æ–¥ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π  
–ú–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä, —á–∞—Å—Ç–Ω—ã–π —Å–ª—É—á–∞–π –º–µ—Ç–æ–¥–∞ –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π. –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å –ø–æ–º–æ—â—å—é –ø—Ä–æ—Å—Ç–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –æ—Ü–µ–Ω–∏–≤–∞—Ç—å –≤–µ—Å –æ–±—ä–µ–∫—Ç–æ–≤ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏ –ø—Ä–∏ —Ä–µ—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏. 

–í –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è —Å –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–æ–π –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –µ–¥–∏–Ω–∏—á–Ω–æ–º—É –æ–±—ä–µ–∫—Ç—É –∏–∑ –æ–±—É—á–∞—é—â–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è U(X, Xi), –∑–∞–¥–∞–Ω–Ω–∞—è –Ω–∞ –≤—Å–µ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏ –∑–∞–≤–∏—Å—è—â–∞—è –æ—Ç Xi –∫–∞–∫ –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–∞. –¢–∞–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º–∏, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –Ω–∞–ø–æ–º–∏–Ω–∞—é—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–ª—è –≤–æ–∫—Ä—É–≥ —Ç–æ—á–µ—á–Ω–æ–≥–æ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–æ–≥–æ –∑–∞—Ä—è–¥–∞. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–∞ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–ª—è –ø–æ –º–µ—Ä–µ —É–¥–∞–ª–µ–Ω–∏—è –æ—Ç –∑–∞—Ä—è–¥–∞ –æ–±—Ä–∞—Ç–Ω–æ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∫–≤–∞–¥—Ä–∞—Ç—É —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª, —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º–æ–∂–µ—Ç —Å–ª—É–∂–∏—Ç—å –º–µ—Ä–æ–π —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ—á–∫–∏ –æ—Ç –∑–∞—Ä—è–¥–∞. –ö–æ–≥–¥–∞ –ø–æ–ª–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∑–∞—Ä—è–¥–∞–º–∏, –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –≤ –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–µ —ç—Ç–æ–≥–æ –ø–æ–ª—è —Ä–∞–≤–µ–Ω —Å—É–º–º–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª–æ–≤, —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö –≤ —ç—Ç–æ–π —Ç–æ—á–∫–µ –∫–∞–∂–¥—ã–º –∏–∑ –∑–∞—Ä—è–¥–æ–≤. –ï—Å–ª–∏ –∑–∞—Ä—è–¥—ã, –æ–±—Ä–∞–∑—É—é—â–∏–µ –ø–æ–ª–µ, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –∫–æ–º–ø–∞–∫—Ç–Ω–æ–π –≥—Ä—É–ø–ø–æ–π, –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –ø–æ–ª—è –±—É–¥–µ—Ç –∏–º–µ—Ç—å –Ω–∞–∏–±–æ–ª—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã –∑–∞—Ä—è–¥–æ–≤ –∏ —É–±—ã–≤–∞—Ç—å –ø–æ –º–µ—Ä–µ —É–¥–∞–ª–µ–Ω–∏—è –æ—Ç –Ω–µ–µ.

```R
–ó–∞–¥–∞–µ–º —à–∏—Ä–∏–Ω—É –æ–∫–Ω–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –≤—ã–±–æ—Ä–∫–∏:
getHWidth <- function(xl) {
  l <- nrow(xl)
  h <- rep(0, l)
  for(i in 1:l) { 
    h[i] <- 0.4 —à–∏—Ä–∏–Ω—É –æ–∫–Ω–∞ –∑–∞–¥–∞—ë–º –∫–∞–∫ 0.4, —Ç–∞–∫ —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ —è–≤–ª—è–µ—Ç—Å—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º
  }
  return (h)
}



–°—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –Ω–∞ –≤—ã–±–æ—Ä–∫–µ
distances_to_points <- matrix(0, l, l)
  err <- eps + 1 –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –Ω–∞ –≤—ã–±–æ—Ä–∫–µ
  
  
  
  
  
  –°—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫:
    err <- 0
    for (i in 1:l) {
      class <- potentialFunction(distances_to_points[i, ], potentials, h, xl, type_core)
      err <- err + (class != xl[i, n])
    }
```

core.E <- function(r) (3/4)(1-r^2)(abs(r) <= 1) –Ø–¥—Ä–æ –ï–ø–∞–Ω–µ—á–Ω–∏–∫–æ–≤–∞
<p><img src= "–ï —è–¥—Ä–æ.PNG">
  
core.Q <- function(r) (15/16)((1 - r^2)^2)(abs(r) <= 1) –ö–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å—Å–∫–æ–µ —è–¥—Ä–æ
<p><img src= "–ö —è–¥—Ä–æ.PNG">

* –î–æ—Å—Ç–æ–∏–Ω—Å—Ç–≤–∞ –º–µ—Ç–æ–¥–∞ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∑–∞–∫–ª—é—á–∞—é—Ç—Å—è –≤ –Ω–µ–ª–∏–Ω–µ–π–Ω–æ–º —Ä–∞–∑–±–∏–µ–Ω–∏–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–æ–≤. –ß—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–ª–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å –¥—Ä—É–≥–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏.
* –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ ‚Äî –≤ —Ç—Ä—É–¥–Ω–æ–º –≤—ã–±–æ—Ä–µ –ø–æ–¥—Ö–æ–¥—è—â–µ–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —Ç—Ä—É–¥–æ–µ–º–∫–æ—Å—Ç–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –ø—Ä–∏ –±–æ–ª—å—à–æ–º –æ–±—ä–µ–º–µ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ.


## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

<table>
<tr>
<td>–ú–µ—Ç–æ–¥ 1</td>
<td> 1NN </td>
<td> KNN </td>
<td> KWNN </td>
<td> –ü–∞—Ä–∑–µ–Ω–æ–≤—Å–∫–æ–µ –æ–∫–Ω–æ </td>
</tr>
<tr>
<td> –ü–∞—Ä–∞–º–µ—Ç—Ä—ã</td>
<td>  </td>
<td> –ö=6 </td>
<td> K=9 </td>
<td> h=0,4; h=0,1 (–ì–∞—É—Å—Å–æ–≤—Å–∫–æ–µ) </td>
</tr>
<tr>
<td> –í–µ–ª–∏—á–∏–Ω–∞ –æ—à–∏–±–æ–∫</td>
<td> 0,47 </td>
<td> 0,33 </td>
<td> 0,33 </td>
<td> 0,4 </td>
</tr>
</table>


# –ë–∞–π–µ—Å–æ–≤—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
–ï—Å–ª–∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤ –∏–∑–≤–µ—Å—Ç–Ω—ã, —Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏,–∏–º–µ—é—â–∏–π –º–∏–∏–º–∞–ª—å–Ω—É—é –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—à–∏–±–æ–∫,–º–æ–∂–Ω–æ –≤—ã–ø–ª–Ω–∏—Ç—å –≤ —è–≤–Ω–æ–º –≤–∏–¥–µ.
* –ê–ø—Ä–∏–∞–æ—Ä–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –∫–∞–∂–¥–æ–≥–æ –∏–∑ –∫–ª–∞—Å—Å–∞. 
* –£—Å–ª–æ–≤–Ω–∞—è –≤–µ—Ä—è—Ç–Ω–æ—Å—Ç—å P(y(x)) –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∞–ø–æ—Å—Ç–µ—Ä–∏–æ—Ä–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é –∫–ª–∞—Å—Å–∞ —É –¥–ª—è –æ–±—ä–µ–∫—Ç–∞ —Ö. 

# –õ–∏–Ω–∏–∏ —É—Ä–æ–≤–Ω—è

–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å –ø–ª–æ—Ç–Ω–æ—Å—Ç—å—é –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è n-–º–µ—Ä–Ω—ã–º –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º(–ì–∞—É—Å—Å–æ–≤—Å–∫–∏–º) —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–µ–º —Å –º–∞—Ç.–æ–∂–∏–¥–∞–Ω–∏–µ–º (—Ü–µ–Ω—Ç—Ä–æ–º)  –∏ –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–µ–π.

<p><img src= "–ª–∏–Ω–∏–∏–∏ —É—Ä–æ–≤–Ω—è.png">

<p><img src= "–ª–∏–Ω–∏ —É—Ä–æ–≤–Ω—è2.png">
  
  
<p><img src= "–ª–∏–Ω–∏–∏ —É—Ä–æ–≤–Ω—è3.png">
  
  
  # –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç
  
  –ù–æ—Ä–º–∞–ª—å–Ω—ã–π –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑ ‚Äî —ç—Ç–æ –æ–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –±–∞–π–µ—Å–æ–≤—Å–∫–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, –≤ –∫–æ—Ç–æ—Ä–æ–º –≤ –∫–∞—á–µ—Å—Ç–≤–µ –º–æ–¥–µ–ª–µ–π –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—ã—Ö –ø–ª–æ—Ç–Ω–æ—Å—Ç–µ–π —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–µ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏: 
  
<p><img src= "—Ñ–æ—Ä–º—É–ª–∞ 1.PNG">
  
  –≥–¥–µ <p><img src= "—Ñ–æ—Ä–º—É–ª–∞ 2.PNG"> ‚Äî –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ (—Ü–µ–Ω—Ç—Ä),<p><img src= "—Ñ–æ—Ä–º—É–ª–∞ 3.PNG"> ‚Äî –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞. –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ –º–∞—Ç—Ä–∏—Ü–∞ ùõ¥ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è, –Ω–µ–≤—ã—Ä–æ–∂–¥–µ–Ω–Ω–∞—è, –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è. –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è ùúáO,ùõ¥O –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ ùë¶‚ààùëå –∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è—è –≤ —Ñ–æ—Ä–º—É–ª—É –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –±–∞–π–µ—Å–æ–≤—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏, –ø–æ–ª—É—á–∏–º –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π (plug-in) –∞–ª–≥–æ—Ä–∏—Ç–º –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ª–∏–±–æ –ª–∏–Ω–µ–π–Ω—ã–π –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç –§–∏—à–µ—Ä–∞ (–µ—Å–ª–∏ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç—å, —á—Ç–æ –º–∞—Ç—Ä–∏—Ü—ã –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–∏ —Ä–∞–≤–Ω—ã –¥–ª—è –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤). –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Ü–µ–Ω–∏–≤–∞—é—Ç —Å–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞ –º–∞–∫—Å–∏–º—É–º–∞ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è: 
  <p><img src= "—Ñ–æ—Ä–º—É–ª–∞ 4.PNG">
  
 –ù–∞–ø–∏—à–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∏—Ç –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π (plug-in) –∞–ª–≥–æ—Ä–∏—Ç–º.  
  
  ```R
  ## –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è 
estimateMu <- function(objects) 
{     


## mu = 1 / m  *  sum_{i=1}^m(objects_i)     
rows <- dim(objects)[1]     
cols <- dim(objects)[2]          
mu <- matrix(NA, 1, cols)     
for (col in 1:cols)      
{         
mu[1, col] = mean(objects[,col])     
}          
return(mu) 
} 


 ##  –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è 
estimateCovarianceMatrix <- function(objects, mu) 
{     
rows <- dim(objects)[1]     
cols <- dim(objects)[2]     
sigma <- matrix(0, cols, cols)          
for (i in 1:rows)     
{         
sigma <- sigma + (t(objects[i,] - mu) %*% 
(objects[i,] - mu)) / (rows - 1)     
}          
return (sigma) 
} 


 ## –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–æ—á–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ 
getPlugInDiskriminantCoeffs <- function(mu1, sigma1, mu2, sigma2) 
{     


## Line equation: a*x1^2 + b*x1*x2 + c*x2 + d*x1 + e*x2 + f = 0     
invSigma1 <- solve(sigma1) 
    invSigma2 <- solve(sigma2)          
f <- log(abs(det(sigma1))) - log(abs(det(sigma2))) + mu1 %*% invSigma1 %*% t(mu1) - mu2 %*% invSigma2 %*% t(mu2);          
alpha <- invSigma1 - invSigma2     
a <- alpha[1, 1]     
b <- 2 * alpha[1, 2]    
c <- alpha[2, 2]          
beta <- invSigma1 %*% t(mu1) - invSigma2 %*% t(mu2)     
d <- -2 * beta[1, 1]     
e <- -2 * beta[2, 1] 
     return (c("x^2" = a, "xy" = b, "y^2" = c, "x" = d, "y" = e, "1" = f)) 
} 


## –û—Ü–µ–Ω–∏–≤–∞–Ω–∏–µ 
objectsOfFirstClass <- xl[xl[,3] == 1, 1:2] 
objectsOfSecondClass <- xl[xl[,3] == 2, 1:2] 
mu1 <- estimateMu(objectsOfFirstClass) 
mu2 <- estimateMu(objectsOfSecondClass) 
 sigma1 <- estimateCovarianceMatrix(objectsOfFirstClass, mu1) 
 sigma2 <- estimateCovarianceMatrix(objectsOfSecondClass, mu2) 
 coeffs <- getPlugInDiskriminantCoeffs(mu1, sigma1, mu2, sigma2) 
 
 
 ## –†–∏—Å—É–µ–º –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç—É—é —Ñ—É–Ω–∫—Ü–∏—é ‚Äì –∫—Ä–∞—Å–Ω–∞—è –ª–∏–Ω–∏—è 
x <- y <- seq(-10, 20, len=100)  
z <- outer(x, y, function(x, y) coeffs["x^2"]*x^2 +  coeffs["xy"]*x*y + coeffs["y^2"]*y^2 + coeffs["x"]*x + coeffs["y"]*y + coeffs["1"])  
 contour(x, y, z, levels=0, drawlabels=FALSE, lwd = 3, col = "red", add = TRUE) 
 
  ```

# –õ–∏–Ω–µ–π–Ω—ã–π –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç –§–∏—à–µ—Ä–∞
–õ–∏–Ω–µ–π–Ω—ã–π –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç –§–∏—à–µ—Ä–∞ (–õ–î–§), –∫–æ—Ç–æ—Ä—ã–π, –≤ –æ—Ç–ª–∏—á–∏–∏ –æ—Ç –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–æ—á–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞, –ø—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –∫–ª–∞—Å—Å–æ–≤ —Ä–∞–≤–Ω—ã, –∏ –¥–ª—è –∏—Ö –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ (–≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤) –æ–±—ä–µ–∫—Ç—ã –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏. 
 
```R
## –û—Ü–µ–Ω–∫–∞ –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã –¥–ª—è –õ–î–§ 
estimateFisherCovarianceMatrix <- function(objects1, objects2, mu1, mu2)  
{     
rows1 <- dim(objects1)[1]     
rows2 <- dim(objects2)[1]     
rows <- rows1 + rows2     
cols <- dim(objects1)[2]          
sigma <- matrix(0, cols, cols)          
for (i in 1:rows1)     
{         
sigma <- sigma + (t(objects1[i,] - mu1) %*% 
(objects1[i,] - mu1)) / (rows + 2)     
}          
for (i in 1:rows2)     
{         
sigma <- sigma + (t(objects2[i,] - mu2) %*% 
(objects2[i,] - mu2)) / (rows + 2)     
}          
return (sigma) 
}


 ## –û—Ü–µ–Ω–∏–≤–∞–Ω–∏–µ 
objectsOfFirstClass <- xl[xl[,3] == 1, 1:2] 
objectsOfSecondClass <- xl[xl[,3] == 2, 1:2] 
mu1 <- estimateMu(objectsOfFirstClass) 
mu2 <- estimateMu(objectsOfSecondClass) 
 Sigma <- estimateFisherCovarianceMatrix(objectsOfFirstClass, objectsOfSecondClass, mu1, mu2) 
 
 
 ## –ü–æ–ª—É—á–∞–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –õ–î–§ 
inverseSigma <- solve(Sigma) alpha <- inverseSigma %*% t(mu1 - mu2) 
mu_st <- (mu1 + mu2) / 2 
beta <- mu_st %*% alpha 
```



# –õ–∏–Ω–µ–π–Ω—ã–µ –∫–ª–∞—Å—Å–∏–∏–∫–∞—Ç–æ—Ä—ã
# –ú–µ—Ç–æ–¥ —Å—Ç–∞—Ö–æ—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞
–¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–π—Ç–∏ –≤–µ—Ç–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ w, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–º –æ—Å—Ç—Ç–æ—á–Ω–æ –º–Ω–∏–º–º–∞ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∏—Ä–≤–∞–Ω–æ–≥–æ —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–≥–æ —Ä–∏—Å–∫–∞.
–ü—Ä—Ä–∏–º–µ–Ω—è–µ–º –º–µ—Ç–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–æ —Å–ø—É—Å–∫–∞. –í —ç—Ç–æ–º –º–µ—Ç–æ–¥–µ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –Ω–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ –¥–ª—è w, –∑–∞—Ç–µ–º –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –∫–æ—Ç–æ—Ä–≥–æ –≤–µ–∫—Ç–æ—Ä w –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –Ω–∞–∏–±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–æ–≥–æ —É–±—ã–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ Q. 
